/* simple nonce handshake protocols */

(new key)
(*(ch?n.   /*** Alice ***/
     (new msg)
      begin msg.
      ch!{(msg,n)}key
   )
 |
 *(new non)  /*** Bob ***/
    (ch!non
     |
     ch?ctext.
     decrypt ctext is {x}key.
     split x is (m,non2).
     check non is non2.
     end m.O)
)

