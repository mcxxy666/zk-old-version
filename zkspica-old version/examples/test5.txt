/* flawed simple nonce handshake protocols (begin is missing) */

(new key)
(*(ch?n.
     (new msg)/*** begin msg. ***/ ch!{(msg,n)}key
   )
 |
 *(new non)
    (ch!non
     |
     ch?ctext.
     decrypt ctext is {x}key.
     split x is (m,non2).
     check non is non2.
     end m.O)
)

